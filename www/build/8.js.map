{"version":3,"sources":["../../src/pages/main/main.module.ts","../../src/pages/main/main.ts"],"names":[],"mappings":"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","file":"8.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { QRCodeModule } from 'angularx-qrcode';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MainPage } from './main';\n\n\n@NgModule({\n  declarations: [\n    MainPage\n  ],\n  imports: [\n    QRCodeModule,\n    IonicPageModule.forChild(MainPage),\n  ],\n})\nexport class MainPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/main.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Loading, LoadingController, Platform, AlertController, ToastController, Modal, ModalController, ModalOptions } from 'ionic-angular';\nimport { Storage } from '@ionic/storage';\nimport { ActivatePage} from '../activate/activate';\nimport { RestProvider } from '../../providers/rest/rest';\nimport { Device } from '@ionic-native/device';\n//import { Subscription } from 'rxjs';\nimport { EditContactPage } from '../edit-contact/edit-contact';\nimport { BarcodeScanner } from '@ionic-native/barcode-scanner';\n\n\n/**\n * Generated class for the MainPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-main',\n  templateUrl: 'main.html',\n})\nexport class MainPage {\n  qrData = null;\n  createdCode = null;\n  elementType = 'canvas';\n  codeWidth = '80';\n  contact_name = '';\n  company_name = '';\n  activatePage = ActivatePage;\n  c_contact_id = '';\n  loading: Loading;\n  summary = '';\n  role ='';\n  customStyle = \"toast-nice\";\n \n\n  constructor(\n    public navCtrl: NavController, \n    public navParams: NavParams, \n    private storage: Storage, \n    private rest: RestProvider, \n    public device: Device,\n    private loadingCtrl: LoadingController,\n    public platform: Platform,\n    private alertCtrl: AlertController,\n    private toastCtrl: ToastController,\n    private modal: ModalController,\n    private scanner: BarcodeScanner ) {\n\n//      this.onResumeSubscription = platform.resume.subscribe(()=>{\n//       this.storage.get(\"session\").then((val) => {\n//          this.contact_name = val.concat_ws;\n//          this.company_name = val.company;\n//          this.c_contact_id = val.c_contact_id;\n//          this.confirmSession();\n//        });\n//      });\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad MainPage');\n  }\n\n  ionViewDidEnter(){\n\n    this.rest.settings().then(\n      (resolve : {settings}) => {\n        console.log(\"Store Settings\", JSON.stringify(resolve.settings));\n        if (resolve.settings != null){\n          this.storage.set('settings', resolve.settings);\n        }\n      }\n    );\n\n    this.storage.get(\"session\").then((val) => {\n      this.contact_name = val.concat_ws;\n      this.company_name = val.company;\n      this.c_contact_id = val.c_contact_id;\n      this.confirmSession();\n    });\n    \n  }\n  doRefresh(refresher){\n    this.storage.get(\"session\").then((val) => {\n      this.contact_name = val.concat_ws;\n      this.company_name = val.company;\n      this.c_contact_id = val.c_contact_id;\n      this.confirmSession();\n    });\n    refresher.complete();\n  }\n  confirmSession(){\n    this.showLoading()\n    let confirmData = {\n      c_contact_id : this.c_contact_id,\n      device_id: this.device.uuid,\n      serial: this.device.uuid\n    }\n    this.rest.confirm(confirmData).then(\n      (resolve: {session_id}) =>{\n        console.log('Confirm Result:', JSON.stringify(resolve));\n        if (resolve.session_id != null){\n          this.storage.set('session_id', resolve.session_id);\n          this.createdCode = resolve.session_id;\n          this.storage.get('role').then((role)=>{\n            this.role = role;\n            console.log('Events Role:', this.role);\n          });\n          this.rest.profile().then(\n            (resolve) =>{\n              console.log(\"Profile\");\n              this.storage.get(\"profile\").then((profile) => {\n                this.summary = profile.Company.summary; \n                console.log(\"Summary\", JSON.stringify(profile.Company.summary));\n              });\n          }, (reject) => {\n            console.log(\"Profile Reject\", JSON.stringify(reject));\n          });\n        }\n    }, (reject) => {\n      console.log(\"Not Confirmed\", JSON.stringify(reject));\n      \n      if (reject.status == '0' ){\n        this.storage.get(\"session_id\").then((val) => {\n          this.createdCode = val;\n        });\n      } else {\n        this.presentToast(JSON.stringify(reject.error.error.message));\n        this.storage.set(\"session_id\", null);\n        this.storage.set(\"session\", null);\n        this.storage.set(\"success\", false);\n        this.navCtrl.push(this.activatePage);\n      }\n    });\n    \n    this.loading.dismiss();\n    \n  }\n  contactEdit(){\n    console.log(\"contact edit\");\n    const detailOptions: ModalOptions = {\n      enableBackdropDismiss: true\n    };\n    const detail: Modal = this.modal.create(EditContactPage, {  }, detailOptions);\n    detail.present();\n  }\n  goBalance(){\n    console.log(\"balance page\"); \n  }\n  partnerEdit(){\n    console.log(\"bartner edit\");\n  }\n\n  showLoading() {\n    this.loading = this.loadingCtrl.create({\n      content: 'Please wait...',\n      dismissOnPageChange: true\n    });\n    this.loading.present();\n  }\n  showError(text) {\n    let alert = this.alertCtrl.create({\n      title: 'Error',\n      subTitle: text,\n      buttons: ['OK']\n    });\n    alert.present();\n  }\n  presentToast(msg) {\n\n    let toast = this.toastCtrl.create({\n      message: msg,\n      showCloseButton: true,\n      closeButtonText: 'Ok',\n      position: 'middle',\n      cssClass: this.customStyle\n    });\n  \n    toast.onDidDismiss(() => {\n      console.log('Dismissed toast');\n      this.customStyle = \"toast-nice\";\n    });\n    toast.present();\n  }\n  scanQRFav(){\n    console.log(\"fav Action\");\n    this.storage.get(\"session_id\").then((session_id) => {\n      const qrData = {type: \"Both\", record_id: null, session_id: session_id };\n      this.scanner.scan().then((qr)=>{\n        qrData.record_id = qr.text;\n        console.log(\"Fav Scan Payload\", JSON.stringify(qrData));\n        this.rest.transaction(qrData).then((resolve: {message, style} ) => {\n          if (resolve.style != undefined) {\n            this.customStyle = resolve.style;\n          }\n          this.presentToast(resolve.message);\n        }, reject => {\n          if (reject.status == '0' ){\n            this.customStyle = \"toast-danger\";\n            this.presentToast(\"No hay comunicacion con el servicio. Revise su conexion a internet\");\n          } else {\n            this.presentToast(JSON.stringify(reject.error.error.message));\n          }\n        })\n      })\n    })\n\n  }\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/main.ts"],"sourceRoot":""}