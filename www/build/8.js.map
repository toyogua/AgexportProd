{"version":3,"sources":["../../src/pages/main/main.module.ts","../../src/pages/main/main.ts"],"names":[],"mappings":"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","file":"8.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { QRCodeModule } from 'angularx-qrcode';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { MainPage } from './main';\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    MainPage\r\n  ],\r\n  imports: [\r\n    QRCodeModule,\r\n    IonicPageModule.forChild(MainPage),\r\n  ],\r\n})\r\nexport class MainPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/main.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, Loading, LoadingController, Platform, AlertController, ToastController, Modal, ModalController, ModalOptions } from 'ionic-angular';\r\nimport { Storage } from '@ionic/storage';\r\nimport { ActivatePage} from '../activate/activate';\r\nimport { RestProvider } from '../../providers/rest/rest';\r\nimport { Device } from '@ionic-native/device';\r\n//import { Subscription } from 'rxjs';\r\nimport { EditContactPage } from '../edit-contact/edit-contact';\r\nimport { BarcodeScanner } from '@ionic-native/barcode-scanner';\r\n\r\n\r\n/**\r\n * Generated class for the MainPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-main',\r\n  templateUrl: 'main.html',\r\n})\r\nexport class MainPage {\r\n  qrData = null;\r\n  createdCode = null;\r\n  elementType = 'canvas';\r\n  codeWidth = '80';\r\n  contact_name = '';\r\n  company_name = '';\r\n  activatePage = ActivatePage;\r\n  c_contact_id = '';\r\n  loading: Loading;\r\n  summary = '';\r\n  role ='';\r\n  customStyle = \"toast-nice\";\r\n \r\n\r\n  constructor(\r\n    public navCtrl: NavController, \r\n    public navParams: NavParams, \r\n    private storage: Storage, \r\n    private rest: RestProvider, \r\n    public device: Device,\r\n    private loadingCtrl: LoadingController,\r\n    public platform: Platform,\r\n    private alertCtrl: AlertController,\r\n    private toastCtrl: ToastController,\r\n    private modal: ModalController,\r\n    private scanner: BarcodeScanner ) {\r\n\r\n//      this.onResumeSubscription = platform.resume.subscribe(()=>{\r\n//       this.storage.get(\"session\").then((val) => {\r\n//          this.contact_name = val.concat_ws;\r\n//          this.company_name = val.company;\r\n//          this.c_contact_id = val.c_contact_id;\r\n//          this.confirmSession();\r\n//        });\r\n//      });\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('ionViewDidLoad MainPage');\r\n  }\r\n\r\n  ionViewDidEnter(){\r\n\r\n    this.rest.settings().then(\r\n      (resolve : {settings}) => {\r\n        console.log(\"Store Settings\", JSON.stringify(resolve.settings));\r\n        if (resolve.settings != null){\r\n          this.storage.set('settings', resolve.settings);\r\n        }\r\n      }\r\n    );\r\n\r\n    this.storage.get(\"session\").then((val) => {\r\n      this.contact_name = val.concat_ws;\r\n      this.company_name = val.company;\r\n      this.c_contact_id = val.c_contact_id;\r\n      this.confirmSession();\r\n    });\r\n    \r\n  }\r\n  doRefresh(refresher){\r\n    this.storage.get(\"session\").then((val) => {\r\n      this.contact_name = val.concat_ws;\r\n      this.company_name = val.company;\r\n      this.c_contact_id = val.c_contact_id;\r\n      this.confirmSession();\r\n    });\r\n    refresher.complete();\r\n  }\r\n  confirmSession(){\r\n    this.showLoading()\r\n    let confirmData = {\r\n      c_contact_id : this.c_contact_id,\r\n      device_id: this.device.uuid,\r\n      serial: this.device.uuid\r\n    }\r\n    this.rest.confirm(confirmData).then(\r\n      (resolve: {session_id}) =>{\r\n        console.log('Confirm Result:', JSON.stringify(resolve));\r\n        if (resolve.session_id != null){\r\n          this.storage.set('session_id', resolve.session_id);\r\n          this.createdCode = resolve.session_id;\r\n          this.storage.get('role').then((role)=>{\r\n            this.role = role;\r\n            console.log('Events Role:', this.role);\r\n          });\r\n          this.rest.profile().then(\r\n            (resolve) =>{\r\n              console.log(\"Profile\");\r\n              this.storage.get(\"profile\").then((profile) => {\r\n                this.summary = profile.Company.summary; \r\n                console.log(\"Summary\", JSON.stringify(profile.Company.summary));\r\n              });\r\n          }, (reject) => {\r\n            console.log(\"Profile Reject\", JSON.stringify(reject));\r\n          });\r\n        }\r\n    }, (reject) => {\r\n      console.log(\"Not Confirmed\", JSON.stringify(reject));\r\n      \r\n      if (reject.status == '0' ){\r\n        this.storage.get(\"session_id\").then((val) => {\r\n          this.createdCode = val;\r\n        });\r\n      } else {\r\n        this.presentToast(JSON.stringify(reject.error.error.message));\r\n        this.storage.set(\"session_id\", null);\r\n        this.storage.set(\"session\", null);\r\n        this.storage.set(\"success\", false);\r\n        this.navCtrl.push(this.activatePage);\r\n      }\r\n    });\r\n    \r\n    this.loading.dismiss();\r\n    \r\n  }\r\n  contactEdit(){\r\n    console.log(\"contact edit\");\r\n    const detailOptions: ModalOptions = {\r\n      enableBackdropDismiss: true\r\n    };\r\n    const detail: Modal = this.modal.create(EditContactPage, {  }, detailOptions);\r\n    detail.present();\r\n  }\r\n  goBalance(){\r\n    console.log(\"balance page\"); \r\n  }\r\n  partnerEdit(){\r\n    console.log(\"bartner edit\");\r\n  }\r\n\r\n  showLoading() {\r\n    this.loading = this.loadingCtrl.create({\r\n      content: 'Please wait...',\r\n      dismissOnPageChange: true\r\n    });\r\n    this.loading.present();\r\n  }\r\n  showError(text) {\r\n    let alert = this.alertCtrl.create({\r\n      title: 'Error',\r\n      subTitle: text,\r\n      buttons: ['OK']\r\n    });\r\n    alert.present();\r\n  }\r\n  presentToast(msg) {\r\n\r\n    let toast = this.toastCtrl.create({\r\n      message: msg,\r\n      showCloseButton: true,\r\n      closeButtonText: 'Ok',\r\n      position: 'middle',\r\n      cssClass: this.customStyle\r\n    });\r\n  \r\n    toast.onDidDismiss(() => {\r\n      console.log('Dismissed toast');\r\n      this.customStyle = \"toast-nice\";\r\n    });\r\n    toast.present();\r\n  }\r\n  scanQRFav(){\r\n    console.log(\"fav Action\");\r\n    this.storage.get(\"session_id\").then((session_id) => {\r\n      const qrData = {type: \"Both\", record_id: null, session_id: session_id };\r\n      this.scanner.scan().then((qr)=>{\r\n        qrData.record_id = qr.text;\r\n        console.log(\"Fav Scan Payload\", JSON.stringify(qrData));\r\n        this.rest.transaction(qrData).then((resolve: {message, style} ) => {\r\n          if (resolve.style != undefined) {\r\n            this.customStyle = resolve.style;\r\n          }\r\n          this.presentToast(resolve.message);\r\n        }, reject => {\r\n          if (reject.status == '0' ){\r\n            this.customStyle = \"toast-danger\";\r\n            this.presentToast(\"No hay comunicacion con el servicio. Revise su conexion a internet\");\r\n          } else {\r\n            this.presentToast(JSON.stringify(reject.error.error.message));\r\n          }\r\n        })\r\n      })\r\n    })\r\n\r\n  }\r\n\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/main.ts"],"sourceRoot":""}